---
title: 'å­¦ç”Ÿã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢äº¤æµä¼šãªã‚‹ã‚‚ã®ã«ç™»å£‡ã—ãŸã®ã¨ã„ã‚ã„ã‚è£œè¶³'
date: '2022-03-30T05:01:45'
excerpt: 'å…¨å›½å­¦ç”Ÿã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢äº¤æµä¼šã€ŒNSEEMã€ã«å‚åŠ ã—ã€MDXã§ãƒ–ãƒ­ã‚°ã‚’æ›¸ããƒ†ãƒ¼ãƒã§ç™»å£‡ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸ'
coverImage: 'null'
ogImage: 'null'
category: 'æŠ€è¡“'
tags: ['LT']
private: false
---

<SpeakerDeck src="https://speakerdeck.com/player/c73b18f644fd4ce489b7acea2e5ee619" title="MDXã§ãƒ–ãƒ­ã‚°ã‚’æ›¸ã“ã†" />

æœ€è¿‘[å…¨å›½å­¦ç”Ÿã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢äº¤æµä¼šã€ŒNSEEMã€](https://zli.connpass.com/event/239501/)ã«å‚åŠ ã—ã€MDXã§ãƒ–ãƒ­ã‚°ã‚’æ›¸ãã¨ã„ã†ãŠé¡Œç›®ã§ç™»å£‡ã€ç™ºè¡¨ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚åˆã®LTã ã£ãŸãŸã‚ã‹ã‚¹ãƒ©ã‚¤ãƒ‰ãŒéå¸¸ã«è¦‹ã¥ã‚‰ã„æ„Ÿã˜ã«ãªã£ã¦ã—ã¾ã£ãŸã®ã§ã€ã„ã‚ã„ã‚æ›¸ã„ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚ã‚¹ãƒ©ã‚¤ãƒ‰ã®è£œå®Œã¨ã—ã¦ã©ã†ãã€‚

# Table of content

# MDX?

https://mdxjs.com/

>MDX allows you to use JSX in your markdown content. You can import components, such as interactive charts or alerts, and embed them within your content. This makes writing long-form content with components a blast. ğŸš€
>
><cite>https://mdxjs.com/</cite>

ğŸš€â†ã‹ã‚ã„ã„ã­

# å°å…¥

## é€šå¸¸

ã‚¹ãƒ©ã‚¤ãƒ‰ã ã‘ã ã¨ã‚„ã‚‹ã“ã¨ãŒå¤šã„ï¼ã ã‘ã§æ¸ˆã¾ã›ã¦ã—ã¾ã£ã¦ã„ã¾ã™ãŒã€**å®Ÿéš›ã‚„ã‚‹ã“ã¨ã¯å¤šã„ã§ã™**ã€‚

[å…¬å¼ã®Getting Started](https://mdxjs.com/docs/getting-started/)ã§ã‚‚ã‚ã‚‹ã‚ˆã†ã«ã€å®Ÿéš›ãƒãƒ³ãƒ‰ãƒ©ã‚„ã‚µã‚¤ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿æ¯ã§è¨­å®šãŒç•°ãªã‚Šã¾ã™ã€‚
æ­£ç›´ã“ã“ã§èª¬æ˜ã™ã‚‹ã®ã¯*æœ¬å½“ã«*ã‚ã¡ã‚ƒãã¡ã‚ƒé•·ã„ã®ã§çœç•¥ã—ã¾ã™ã€‚å…¬å¼ã‚’è¦‹ã¦ãã ã•ã„ã€‚

ã¡ãªã¿ã«Reactã®å ´åˆã€Viteã‹Create React App(CRA)ã‹ä½•ã‚‚åˆ©ç”¨ã—ã¦ã„ãªã„ã‹ã€ãƒãƒ³ãƒ‰ãƒ«ãŒesbuildã‹Rollupã‹webpackã‹ã©ã†ã‹ã§ã‚‚å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨è¨­å®šãŒç•°ãªã‚Šã¾ã™ã€‚ã‚­ãƒ„ã„ã€‚ã‚ã¨ã¯Reactä»¥å¤–(Preactã‚‚å«ã‚€)ã¯JSXãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚‚å°å…¥ã™ã‚‹å¿…è¦ã‚ã‚Šã€‚
## Next.js

https://nextjs.org/docs/advanced-features/using-mdx#mdx-plugins

dependenceså…¥ã‚Œã¦ã€

```bash
npm install @next/mdx @mdx-js/loader
```

next.config.jsæ›¸ã„ã¦ã€

```js
// next.config.js

const withMDX = require('@next/mdx')({
  extension: /\.mdx?$/,
  options: {
    remarkPlugins: [],
    rehypePlugins: [],
    // If you use `MDXProvider`, uncomment the following line.
    // providerImportSource: "@mdx-js/react",
  },
})
module.exports = withMDX({
  // Append the default value with md extensions
  pageExtensions: ['ts', 'tsx', 'js', 'jsx', 'md', 'mdx'],
})
```

/pagesã«.mdxãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãŠã„ã¦ã€å®Œæˆï¼
```
  - /pages
    - my-mdx-page.mdx
  - package.json
```
frontmatterç­‰ã¯å­˜åœ¨ã—ãªã„ã®ã§å¯èª­æ€§ã‚„ç¶™ç¶šæ€§ã®é¢ã§ã¯ã‹ãªã‚Šå¾®å¦™ãªæ°—ã‚‚ã—ã¾ã™ãŒã€ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ä½œæˆã—ã¦ä½¿ãˆã°ã‚ã‚‹ç¨‹åº¦ã¯è§£æ±ºã§ãã‚‹ãŸã‚ã€æ°—è»½ã«å§‹ã‚ãŸã„ã®ã§ã‚ã‚Œã°æ­£ç›´ã“ã®ã‚„ã‚Šæ–¹ãŒä¸€ç•ªæ—©ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ãªãŠã“ã®å ´åˆã§ã‚‚@mdx-js/reactã®providerã¯ä½¿ãˆã¾ã™ã€‚

## MDX on demand

https://mdxjs.com/guides/mdx-on-demand/

ä»–ã‹ã‚‰mdxã‚’èª­ã¿è¾¼ã‚“ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã‚„ã‚Šæ–¹ã§ã™ã€‚ã“ã®æ–¹æ³•ã¯@mdx-js/mdxã‚’åˆ©ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯mdxã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è©•ä¾¡ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šå®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚ç¾ä»£çš„ï¼

å°å…¥æ–¹æ³•ã¯é€šå¸¸ã®å ´åˆã¨ã»ã¼åŒæ§˜ã§ã™ã€‚(mdxã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‰±ã„ã—ãªã„ç‚ºã€@mdx-js/loaderã¯ä¸è¦)å…·ä½“çš„ãªå‹•ä½œä¾‹ã¯å¾Œè¿°ã—ã¦ã„ã¾ã™ã€‚


## hashicorp/next-mdx-remote

https://github.com/hashicorp/next-mdx-remote

ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯MDX on demandã¨ã»ã¼åŒç­‰ã§ã™ãŒã€å¤‰æ•°ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚„frontmatterç­‰ã®æ©Ÿèƒ½ãŒä»˜éšã—ã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚tså¯¾å¿œã€‚

ã¡ãªã¿ã«ã“ã®blogã¯ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

ãªãŠ

> **How Can I Build A Blog With This?**
> 
> Data has shown that 99% of use cases for all developer tooling are building unnecessarily complex personal blogs. Just kidding. But seriously, if you are trying to build a blog for personal or small business use, consider just using normal html and css. You definitely do not need to be using a heavy full-stack javascript framework to make a simple blog. You'll thank yourself later when you return to make an update in a couple years and there haven't been 10 breaking releases to all of your dependencies.
>
> <cite>https://github.com/hashicorp/next-mdx-remote#how-can-i-build-a-blog-with-this</cite>

åˆ¥ã«ä½•ä½¿ã£ãŸã£ã¦ã„ã„ã˜ã‚ƒã‚“ï¼(ãã‚Œã¯ãã†)

# MDX on demandã‚’è©¦ã™

ç™ºè¡¨ã§ã¯è»½ãè§¦ã‚Œã‚‹ç¨‹åº¦ã§ã—ãŸãŒã€è‰²ã€…è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚

## åŸºæœ¬

```js
import {useState, useEffect, Fragment} from 'react'
import * as runtime from 'react/jsx-runtime.js'
import {compile, run} from '@mdx-js/mdx'

export default function Page({code}) {
  const [mdxModule, setMdxModule] = useState()
  const Content = mdxModule ? mdxModule.default : Fragment

  useEffect(() => {
    ;(async () => {
      setMdxModule(await run(code, runtime))
    })()
  }, [code])

  return <Content />
}

export async function getStaticProps() {
  const code = String(
    await compile('# hi', {outputFormat: 'function-body' /* â€¦otherOptions */})
  )
  return {props: {code}}
}
```
*https://mdxjs.com/guides/mdx-on-demand/#nextjs-example*

exampleã¯ã“ã‚“ãªæ„Ÿã˜ã€‚

ã—ã‹ã—ã“ã®exampleã ã¨`<Content components={/*hoge*/}/>`ã¨ã—ãŸå ´åˆã«React.Fragmentæ‰±ã„ã®ç‚ºä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚(ãƒ­ãƒ¼ãƒ‰ã¯å‡ºæ¥ã¾ã™)
```
Warning: Invalid prop `components` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.
    at PostBody (webpack-internal:///./components/post-body.tsx:69:21)
    at article
    at div
    at div
    at Container (webpack-internal:///./components/container.tsx:8:22)
    at main
    at div
    at Layout (webpack-internal:///./components/layout.tsx:12:19)
    at Post (webpack-internal:///./pages/posts/[slug].tsx:42:23)
    at exports.ThemeProvider (/home/murasame/vercel_pagedata/node_modules/next-themes/dist/index.js:1:1552)
    at MyApp (webpack-internal:///./pages/_app.tsx:23:18)
    at StyleRegistry (/home/murasame/vercel_pagedata/node_modules/styled-jsx/dist/index/index.js:671:34)
    at AppContainer (/home/murasame/vercel_pagedata/node_modules/next/dist/server/render.js:394:29)
    at AppContainerWithIsomorphicFiberStructure (/home/murasame/vercel_pagedata/node_modules/next/dist/server/render.js:424:57)
    at div
    at Body (/home/murasame/vercel_pagedata/node_modules/next/dist/server/render.js:701:21)
```
ã“ã‚Œã‚’ç›´ã—ã¦ã„ãã¾ã™ã€‚ä¾¿å®œä¸Šã“ã“ã‹ã‚‰ã¯typescriptã§èª¬æ˜ã—ã¾ã™ã€‚ã‚†ã‚‹ã—ã¦

ã¾ãš@mdx-js/mdxã«ã¯å‹ãƒ•ã‚¡ã‚¤ãƒ«(mdx/types)ãŒå­˜åœ¨ã—ã¾ã™ã€‚ãã®ä¸­ã®MDXModuleã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¾Œã®MDXã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®šç¾©ã§ã™ã€‚
mdxModuleã«ã¯MDXModuleå‹ã‚’å…¥ã‚Œã‚Œã°ã„ã„ã®ã§ã€å˜ç´”ã«ãƒ€ãƒŸãƒ¼ã§å¤‰æ•°ã‚’å…¥ã‚Œã¦ã‚ã’ã‚Œã°è§£æ±ºã—ã¾ã™ã€‚å‹¿è«–ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã®ãƒ€ãƒŸãƒ¼ã¯ãã®ã¾ã¾ã§ã¯å‹•ã‹ãªã„ã®ã§ã€runSyncé–¢æ•°ã§MDXModuleã¨ã—ã¦èªè­˜ã•ã›ã¾ã™ã€‚
```tsx
const PostBody = ({ content }: Props): JSX.Element => {
  //  const mdxModule: MDXModule = runSync(content, runtime);
  const [mdxModule, setMdxModule] = useState<MDXModule>(runSync(`/*@jsxRuntime automatic @jsxImportSource react*/
  const {jsx: _jsx} = arguments[0];
  function MDXContent(props = {}) {
    const {wrapper: MDXLayout} = props.components || ({});
    return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
      children: _jsx(_createMdxContent, {})
    })) : _createMdxContent();
    function _createMdxContent() {
      return _jsx("div", {
        style: {
          justifyContent: 'center'
        },
        children: " Loading..."
      });
    }
  }
  return {
    default: MDXContent
  };`, runtime));
    const Content = mdxModule.default
    useEffect(() => {
      (async () => {
        setMdxModule(await run(content, runtime) as MDXModule);
      })()
    }, [content])
    return (
            <Content components={MDXcomponents} />
    );
  };

```
ã“ã‚Œã ã‘ã§ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ï¼(åˆ¥é€”ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯å¿…è¦)ã¡ãªã¿ã«blog-starter-typescriptã‚’æµç”¨ã—ã¦ã„ã‚‹å ´åˆ(è‡ªåˆ†ã®ä¾‹)ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«mdxãŒå­˜åœ¨ã—ã¦ã„ã‚‹ãŸã‚ã€è¡¨ç¤ºã ã‘ãªã‚‰ã°
```tsx
const PostBody = ({ content }: Props): JSX.Element => {
  const mdxModule: MDXModule = runSync(content, runtime);
  const Content = mdxModule.default

  return (
    <div className="max-w-3xl mx-auto">
      <div className={markdownStyles["markdown"]}>
        <Content components={MDXcomponents}/>
      </div>
    </div>
  );
```
ã“ã‚Œã ã‘ã§ã‚‚å‡ºæ¥ã¾ã™ã€‚(ã‚ã¾ã‚ŠãŠã™ã™ã‚ã¯ã—ãªã„)

## importæ–‡(å¤±æ•—)

å…ˆã«æ›¸ã„ã¦ãŠãã¨MDX on demandã§ã‚‚importæ–‡ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚
> Note: MDX is not a bundler (esbuild, webpack, and Rollup are bundlers): you canâ€™t import other code from the server within the string of MDX and get a nicely minified bundle out or so.
>
><cite>https://mdxjs.com/guides/mdx-on-demand/#quick-example</cite>

*æ„è¨³: MDXã¯ãƒãƒ³ãƒ‰ãƒ©ã˜ã‚ƒãªã„ã‚“ã§ã€ä»–ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨ã‹ã€(webpackã¨ã‹Rollupã¿ãŸã„ã«)ã‚³ãƒ¼ãƒ‰åœ§ç¸®ã—ã¦å‡ºåŠ›ã™ã‚‹ã¨ã‹ãã†ã„ã†ã®å‡ºæ¥ãªã„ã£ã™*

ã¨ã„ã†ã‚ã‘ã§Next.jsã§ã‚ã‚Œã°å¤§äººã—ãnext-mdx-remoteã‚’ä½¿ã†ã¹ãã§ã™ã€‚( ~ã¾ã‚ã“ã®è¨˜è¿°ã«æ°—ã¥ã‹ãšæ•°æ™‚é–“æ™‚é–“ä½¿ã£ãŸã‚“ã§ã™ã‘ã©ã­~ )

ã¡ãªã¿ã«ç„¡ç†çŸ¢ç†å‹•ã‹ãã†ã¨ã™ã‚‹ã¨ã“ã†ãªã‚Šã¾ã™ã€‚

![ã ã‚](/assets/blog/nseem-2022/3.jpg)

ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

# ã—ãã¿

åŸºæœ¬çš„ã«ã¯ã‚¹ãƒ©ã‚¤ãƒ‰ã«æ›¸ã„ã¦ã‚ã‚‹ã“ã¨ãŒå…¨ã¦ã§ã™ãŒã€vfileã«ã¤ã„ã¦LTã ã¨æ™‚é–“ãŒãªãã¦é©å½“ãªèª¬æ˜ã«ãªã£ã¦ã—ã¾ã£ãŸã®ã§è£œè¶³ã€‚

[vfile](https://github.com/vfile/vfile)ã¯unified ecosystemã®ä¸­ã«ã‚ã‚‹1ã¤ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ãã®ä»®æƒ³ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æä¾›ã™ã‚‹æŠ€è¡“(?)ã§ã™ã€‚vfileã«é™ã‚‰ãšsyntax-treeç­‰ã‚‚ãã†ã§ã™ãŒã€å¤§ä½“unifiedã®ç‚ºã«ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã“ã¡ã‚‰ã¯ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®ãŸã‚ã®ã‚‚ã®ã‚‰ã—ã„ã€‚

>It was made specifically for unified and generally for the common task of parsing, transforming, and serializing data, where vfile handles everything about the document being compiled. This is useful for example when building linters, compilers, static site generators, or other build tools. vfile is part of the unified collective.
>
><cite>https://github.com/vfile/vfile</cite>

# ä½™è«‡

å ´æ•°ã®å•é¡Œãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚‚ã£ã¨ã“ã†è¦é ˜ã‚ˆãè©±ã›ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã§ã™ã­ã€‚ã‚ã¨å‹äººæ›°ãã‚ã‚“ã¾ã‚Šåˆå¯¾é¢ã®å°è±¡ãŒè‰¯ããªã„ã®ã§ã€ã©ã®ã‚ˆã†ã«ã‚«ãƒãƒ¼ã—ãŸã‚‰ã„ã„ã‹ãªã‚ã¨ã¯æ€ã„ã¾ã™ã€‚çœŸäººé–“ã«ãªã‚Šã¦ãˆã€‚